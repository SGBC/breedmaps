---
title: "Gene function and pathway analysis"
author: "Jenny Jakobsson"
date: "4/9/2021"
output: html_document

params:
  workingDir: '/Users/jj/breedmaps/SVs_identification/'
  annDir: 'data/annotation/'
  scriptDir: 'scripts/gene_annotation/'
  resultsDir: 'results/gene_annotation/filtered_variants/'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library('UniprotR')
library("tidyverse")
# BiocManager::install("UniProt.ws")
library("UniProt.ws")

```

```{r uniprot}
# TaxID 9913 = Bos taurus
up <- UniProt.ws(taxId=9913)
up
cols = columns(up)
all_col = c(cols[14], cols[15], cols[28:38], cols[43], cols[45:51], cols[56:57], cols[63], cols[66], cols[69], cols[72], cols[86], cols[88], cols[100:102], cols[104:105], cols[115:120])
functions = c(cols[117], cols[1], cols[43], cols[56])

```

```{r}
# Load files
gene_path = paste(params$workingDir, params$resultsDir, sep = "")
gene_file_names = list.files(path = gene_path, pattern = "filt_ann_gene*")
gene_list = list()
for (i in 1:length(gene_file_names)){
  full_path = paste(gene_path,
                  gene_file_names[[i]],
                  sep = "")
  gene_file = read.table(
      file = full_path,
      quote = "",
      sep = "\t",
      header = T,
      stringsAsFactors = F
    )
  gene_list[[i]] = gene_file
  # UniProt recommends max 100 keys per query or else it might fail.
  func <- UniProt.ws::select(up, keys = gene_file$gene_id[1:100], columns = functions, keytype = "ENSEMBL")
  x = inner_join(gene_file, func, left_on="gene_id", right_on="ENSEMBL")
}
```




```{r}
rest <- UniProt.ws::select(up, keys = c("F1MMV1"), columns = functions, keytype = "UNIPROTKB")

```



